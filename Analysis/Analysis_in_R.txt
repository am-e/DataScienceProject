Data Science 2014
Tennis stats/odds analysis in R

// Reads in csv into data.frame
train <- read.table("D:\\School\\Fall 14\\Data Science\\Project\\Data\\Exports\\train.csv",sep=",",header=1)
test <- read.table("D:\\School\\Fall 14\\Data Science\\Project\\Data\\Exports\\test.csv",sep=",",header=1)

// Defines the custom function mosthighlycorrelated() that runs a Pearson's product.moment correlation between each pair of columns in the data frame
mosthighlycorrelated <- function(mydataframe,numtoreport)
  {
     # find the correlations
     cormatrix <- cor(mydataframe)
     # set the correlations on the diagonal or lower triangle to zero,
     # so they will not be reported as the highest ones:
     diag(cormatrix) <- 0
     cormatrix[lower.tri(cormatrix)] <- 0
     # flatten the matrix into a dataframe for easy sorting
     fm <- as.data.frame(as.table(cormatrix))
     # assign human-friendly names
     names(fm) <- c("First.Variable", "Second.Variable","Correlation")
     # sort and print the top n correlations
     head(fm[order(abs(fm$Correlation),decreasing=T),],n=numtoreport)
  }

// Runs the mosthighlycorrelated() function on the odds data frame returning the 20 most correlated columns
mosthighlycorrelated(train[2:8], 20)

First.Variable Second.Variable Correlation
43            fsw              sh   0.8680827
35            fsw             apg   0.8253158
44            ssw              sh   0.8102521
54             sh             bps   0.7375326
45            apg              sh   0.6911396
25           odds             ssw   0.6577476
52            ssw             bps   0.6283489
51            fsw             bps   0.6250054
41           odds              sh   0.6088124
57           odds             rpw   0.5539250
53            apg             bps   0.5119378
49           odds             bps   0.4989102
27            fsw             ssw   0.4758468
61            apg             rpw  -0.4412552
17           odds             fsw   0.4324244
60            ssw             rpw   0.3827928
36            ssw             apg   0.2852064
26            fsi             ssw   0.2723960
42            fsi              sh   0.1890478
9            odds             fsi   0.1860269


//building regression tree
library("rpart")

//creating model
fit <- rpart(odds~ssw+sh,method="anova",data=train)


//Predicting odds based on test data
pred <- predict(fit,test)

//comparing predictions with actual odds in test
all <- data.frame(pred,test)

all

  pred     odds          fsi          fsw          ssw         apg          sh         bps         rpw
1   70.48351 86.41975   3.25872803  -0.55168152   1.99588776 -25.4081802   1.1890488   0.9373932   9.9106636
2   70.48351 76.19048   1.19802475   2.95965576   3.41909790 -11.3997936   3.4353485   4.9900818   6.8691101
3   70.48351 92.65859   5.85516739   5.33764648   5.50831604   2.9154224   6.3979607  14.7667847   3.5606384
4   86.88920 87.41259  -0.88553619  11.63450623  15.02581787  75.1898880  12.6594009  13.1127396  10.0562286
5   38.04946 52.63158  -3.00309372   9.02237701 -16.50922394  24.3148422  -2.7598228  -6.7216568 -12.5134621
6   58.46082 63.68039  -8.47126007   6.34569550  -1.73099136  30.5423756   1.7387886  -4.4387245  -2.9806938
7   38.04946 43.15245  -1.42298126   0.06021118  -5.54100800  11.2073250  -1.9446831   7.8135490  -5.1914406
8   38.04946 68.80734   0.78337860  -3.06792450  -6.06491470  -0.3259735  -4.6359711  -0.2030907   0.3399467
9   86.88920 82.83133   1.86244202  -2.54755402  10.28106689 -18.4593582   3.5763626  -1.9561272  -7.5472565
10  70.48351 92.09517  11.78607559  -2.68948364   1.22138214 -25.4469280   1.0444183   5.8511810   9.2912102
11  38.04946 76.62835   5.71434784  -4.30287170  -3.17723084 -25.3931465  -2.8625793  -1.5382347   3.0176773
12  60.89145 58.13953  -0.97212601  -5.02249908   0.61737060 -44.2699203  -3.1869736   1.8267822   6.1157761
13  86.88920 76.62835   9.89553070  -8.91526794  11.49008942 -23.2131557   1.6750145  -2.9713821 -12.7066650
14  38.04946 34.36754   5.07377625 -24.10979843  -9.18148804  -3.3166046 -17.2704468  -8.7698364   0.5000000
15  38.04946 67.28972 -11.07598495   2.72988892  -2.74990845 -67.8645782  -1.4526596  -8.9264870   4.6148109
16  70.48351 81.03728   1.79484177  11.61734772   4.46293259  46.0089569   8.9813881  -1.8279076  -1.6498909
17  38.04946 29.03930  -5.93337250 -15.72502136  -9.05913925 -79.3189087 -14.6482506  -6.6343460  -1.8196545
18  70.48351 82.83133  -7.36309815  11.08407593   2.79666901  47.4571495   6.1831551  18.7411957  -0.3334122
19  60.89145 43.15245  -2.94573975  -2.58913422   0.49376297   9.2546215  -1.9565125  -3.3880730  -1.2447853
20  70.48351 82.83133  -3.20107651   3.90750122   2.78279495  21.3982124   2.8556900  10.9995117   1.3126640
21  86.88920 70.49892  -0.88553619  11.63450623  15.02581787  75.1898880  12.6594009  13.1127396  10.0562286
22  38.04946 60.25316  -6.25244904  -6.86994171  -2.03929901 -58.6871872  -6.5131531  -0.8557854   8.5227089
23  58.46082 63.68039   6.16670609   0.84997559  -0.09521484   5.1085396   1.5410919   0.6473732  -0.1197166
24  86.88920 92.72468   8.71177292   0.12493896  14.60046768 -28.1339321   8.1769562   1.4745674  -4.5574837
25  70.48351 50.00000   6.80823135   9.82495499   5.13406753  57.6766348   9.2074203   8.3347244  -1.5516434
26  58.46082 65.63246  -9.16838837   4.59165955  -4.24188995 -53.8741150  -0.4966660  -5.1158600   3.1833687
27  70.48351 76.62835  -3.76813507   6.41082764   4.99451065  18.5270424   5.1568794  21.2686958   0.9286690
28  70.48351 34.36754  15.91407394  -2.29529571   1.52749252 -11.7239609   2.4926071  -0.8755493  -4.3680077
29  70.48351 92.72468   8.31660461   4.95565033   5.57427216  -5.0088654   6.9598351   6.7148933   7.9536972
30  70.48351 76.62835  -1.32118607   9.70170593   3.61730957  46.9446259   6.9346657   2.8757210  -3.1839523
31  86.88920 76.62835  -7.02466583   8.10014343   6.17999649  28.4893169   6.1859055  -0.1225700   0.1735878
32  58.46082 63.68039   6.49600220  -1.73397827  -2.76416779  34.8677025  -0.6701202  -1.2237053   0.1254311
33  70.48351 88.20287   6.57394791   6.58724976   1.81878662  21.5217743   5.9854507  11.3361740   0.5960312
34  58.46082 63.68039   0.42727280   4.98377991  -0.30859757  30.9405098   3.1484146   7.5548477  -1.0174026
35  70.48351 73.06889  -9.32006073   9.64724731   5.28055573  40.6035042   6.1649628   8.4782715  -2.9709663
36  86.88920 94.95252  12.90296555   9.51678467   8.75245667  34.7216034  11.8648338   7.9554062   9.5451736
37  86.88920 67.28972 -10.92750931   2.33157349   6.35859680  20.9259338   0.8277283   0.0798378  14.8396492
38  70.48351 67.28972   4.07302475   5.57907105   5.32791519  11.4302330   6.1081848  19.5540352   1.2465324
39  86.88920 95.79342   3.87458038   8.53938294  12.50671387  28.9589005  10.7913284   9.5606613   7.5001907
40  70.48351 82.83133   4.58623123   6.27788925   3.86806869   0.8703232   5.4824448   4.5331383   9.2736816
41  86.88920 86.41975   4.90644074  12.97314072  15.74163055  25.5742474  15.2720184  23.9479523   6.4632225
42  58.46082 84.15147  14.35660553   1.06298065  -0.16895294 -34.7628622   2.3234138 -14.8565903  12.9435902
43  38.04946 18.96272  -5.30732727  -0.26825714  -9.96855164   1.1220055  -5.7359314  -9.4645386  -2.8779526
44  70.48351 87.41259  -1.15034103   3.14299011   2.05130005  26.2505474   2.8863297  -1.5437851   6.9216003
45  86.88920 73.06889  -0.21825409  14.54935455  18.91000366  83.8050575  16.1026726  14.6611099   2.7022285
46  86.88920 76.62835  10.45314407  14.94976044   7.04016876  89.3843975  14.0262337  19.1050911  -5.5439415
47  38.04946 43.15245   1.07129288  -2.26553345  -9.68187332 -33.2549534  -5.5532761 -11.3927116  -0.3562355
48  70.48351 76.62835  -4.81370926   5.43459320   4.64392853  10.4125423   4.4934044   4.8156242  -0.3536110
49  86.88920 95.79342  12.57563782   3.27603912  16.10019302  -2.9004326  11.1115112  17.9341507  10.1428757
50  86.88920 63.22116  -4.25019074   3.51002502   6.10491180  -2.3793983   3.8446350   8.0843735   3.9678841
51  86.88920 87.41259   5.27410126   6.74803162   8.47236633   0.6510258   8.3790283  17.2816162   5.2053719
52  70.48351 70.96070   1.41203308  -6.78631592   2.72401428 -35.2571526  -3.0903282   7.6544151   7.5343742
53  86.88920 93.63296   2.88837051   4.18998718   7.05410767  18.6295986   6.0552750  -4.6173019   8.6160316
54  70.48351 62.03474  -5.54644394   8.86453247   4.89832687  38.0706215   6.5820847  -2.4613647  -4.9406853
55  86.88920 76.62835  -2.95284271   6.31814575   8.58975983  33.8456345   6.5903244   9.8214264   1.5057526
56  38.04946 78.94737   5.25764465  -4.30543518  -2.22630310  -3.0205975  -2.6177711  -6.6760902   0.5596390
57  86.88920 87.41259   5.50224304   8.36561203   6.43448639  14.1798954   9.2721138  21.1431999   2.2560616
58  38.04946 29.03930  -3.12878418  -3.39119721 -11.38826752 -22.9577255  -6.6475868  -5.6582184  -7.4882889
59  70.48351 65.63246   5.90245819  -2.65336609   5.18649292  11.4164448   2.1648865   3.6021690   2.5697746
60  70.48351 78.94737   7.04494858   9.03263855   3.87146378  59.0548515   8.7476883   4.9610100  -0.5383415
61  70.48351 47.36842   1.90823746   1.18040466   1.78220749   2.0255356   1.6113434   3.5882835  -2.7701416
62  70.48351 52.63158   0.66728210   2.91484833   3.88418579   8.6151695   3.4432716   1.5483704  -7.3540001
63  86.88920 92.09517  11.12311172  10.75232697   7.76896667  -2.9039116  11.4909554  19.1811485   7.8303528
64  58.46082 54.83029   1.12705231   1.58973694  -1.15201569   1.5675793   0.6868935  -1.4148483   0.4202690
65  70.48351 90.57971  -3.93905258   1.96875000   3.13715362  23.5163326   1.8542709  -4.3565369   2.6215935
66  86.88920 47.36842  -4.44507217   9.80786896  10.24620438  30.0432701   8.9989624   9.2819443  -1.9144135
67  86.88920 68.80734   1.09365463   7.48272705  17.47130966  48.9094505  11.1986809   9.1666527   3.8614311
68  70.48351 70.96070   6.24164963   5.07816315   3.00723648  24.8111572   5.3684540   9.1915207   0.3055573
69  58.46082 65.63246   2.34078980   6.16059112 -10.52540588 -22.0476170  -1.1465034 -16.0404053   4.4723339
70  86.88920 88.20287   6.72047043  -2.06160736  10.59187698  -5.8158550   4.7135506   3.1673660   6.5822372
71  58.46082 88.20287  10.39198685  -2.12551880  -3.65027237  -1.7924805  -0.7073975  -4.0418816   4.2477188
72  86.88920 84.15147   1.53882599   5.89347076   8.81932831   3.7612610   7.7724533   1.2293816   2.6849823
73  86.88920 84.15147   3.25494385   3.13602448  10.06859207 -34.3629055   6.2656326  10.5833206   5.5389214
74  70.48351 68.80734 -12.53322601  18.18807983   1.59641266  88.8306122   9.5884933   3.5945740  -4.4180222
75  70.48351 82.83133   1.98113251  -8.17027283   2.30367279 -87.5801086  -3.6895676 -23.2826881  11.4378014
76  86.88920 92.72468   2.48785400   2.92622376  21.90421295   7.0949554  11.8086548   8.5133553  16.4029083
77  86.88920 68.80734   8.18885040   2.22068024   6.27263641  -1.6067963   5.2494087  -6.9180603   5.9767647
78  70.48351 94.39200  -7.00864792   9.69832611   1.86820221  28.7954559   5.7693710   2.8174362  -2.9882355
79  70.48351 88.20287   4.87361526   1.38621521   5.40930557  -2.4056511   3.8281021  -7.7629051   7.3130760
80  58.46082 58.13953  -2.13563919   2.57759094  -2.72544479  -6.1997414  -0.1707726 -11.6302795  -5.0676918
81  86.88920 78.94737   5.35300064  -4.95409393  20.42547989 -26.9108238   6.9957886  -3.2774925  13.6275024
82  86.88920 39.74684  -0.87179184  -1.00531006   5.89309311 -22.3617306   1.6848602  -3.6451340   9.2708569
83  86.88920 89.46322   1.60215378  -1.38313293  11.66889954 -36.9763031   3.6301041   8.1249580  10.0261536
84  86.88920 93.63296   2.48785400   2.92622376  21.90421295   7.0949554  11.8086548   8.5133553  16.4029083
85  86.88920 85.41393   7.23250961   2.00254822   6.10898972   0.1828423   5.3758850  16.5948715   3.9438457
86  86.88920 94.39200  -8.36819840  14.88626862   5.69633102  63.0604858  10.2268295  12.4655342  -1.9795609
87  70.48351 67.28972  -6.39263535   8.46621704   2.44798279  15.6806412   4.5335960   0.9226837  11.5596485
88  86.88920 86.41975   2.80636978   7.96079254   8.82032394   7.7471161   8.9672928  10.1860886   3.4475975
89  60.89145 73.06889   6.29016495  -3.83211517  -0.25458527 -18.0532703  -1.6244240  -1.1091652   2.4123878
90  58.46082 62.03474   7.64503098   1.54378510  -1.01947021  -2.8826275   2.2630424  -6.0585175  -1.4316368
91  58.46082 62.03474 -12.51332855   8.12477112  -2.89977264  35.0370941   1.8916435   3.2524643   2.4135704
92  70.48351 95.79342   7.72296524  10.42900848   5.66510391  -5.2725868  10.1924629   9.5099068   9.2852097
93  86.88920 92.72468  -6.28487778  23.23239517  14.45604324  50.9639072  19.1940193  19.8535576   2.3866653
94  86.88920 86.41975   0.54419327  14.82601547   7.93364334  61.0038014  11.8417587  11.7755089  -2.0182686
95  70.48351 81.03728   8.49276733  -0.50295258   1.32835388 -13.8544178   1.2226753   1.5498657   3.8729362
96  86.88920 73.06889   7.86112213   7.28247070  13.55272293  61.6941147  12.3746071  -0.4633942  -0.8314285
97  86.88920 86.41975   8.21386719   7.91972351   8.42673492  49.1930695  10.0363846   7.2433739  -4.4897499
98  38.04946 50.00000  -5.55223846 -10.52410126 -10.43600082 -45.2482090 -13.0730248 -26.5790634   2.2817726
99  70.48351 84.15147 -10.30912018  -5.01257324   5.66146088 -64.0257950  -3.1017609  -4.2036018   8.3667412
100 70.48351 56.84755  -4.76309586   2.71178436   2.73721314  -6.9398537   1.9428711   0.7779922  -0.9020958
101 58.46082 76.62835   9.12522888  -2.08607483  -2.79019165  16.6432762   1.0247116  -8.5649643  -3.9109993
102 70.48351 92.09517   0.04680252  21.69635391   4.43365097  16.6612663  15.1545334   5.8646545   0.5900993
103 70.48351 73.06889   4.65933227   9.39735794   2.03857422  30.9350023   6.6726799   5.0685043  -0.4485931
104 58.46082 85.41393   7.38858795   5.16026306   0.39348984  19.0906448   4.5396004   6.1334572   6.1911774
105 86.88920 87.41259  -2.86139679  -9.15449524  16.69132614  -4.6132050   0.7783966  18.0438728   2.2127419
106 86.88920 81.03728  -1.44309235  -3.26803589  17.65400696  42.6297836   5.0069885  26.7402344  -4.6904907
107 86.88920 92.65859   5.79476547  18.92506409   9.04706955  62.9282889  15.7822304  19.8228798  -6.3970909